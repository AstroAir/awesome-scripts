// ==UserScript==
// @name        Linux.do Forum Post Exporter
// @description Export forum posts from linux.do with replies in JSON or HTML format - Optimized & Beautiful with i18n support
// @version     2.1.0
// @author      Forum Exporter
// @match       https://linux.do/t/*
// @match       https://linux.do/t/topic/*
// @grant       GM_getValue
// @grant       GM_setValue
// @license     MIT
// @namespace   https://linux.do/
// @run-at      document-idle
// ==/UserScript==

(()=>{"use strict";const e={en:{exportJSON:"Export JSON",exportHTML:"Export HTML",exportMarkdown:"Export Markdown",embedImages:"Embed images",language:"Language",convertingImages:"Converting images to base64...",convertingImagesJSON:"Converting images to base64 for JSON export...",convertingImagesMarkdown:"Converting images to base64 for Markdown export...",exportingJSON:"Exporting to JSON...",exportingHTML:"Exporting to HTML...",exportingMarkdown:"Exporting to Markdown...",exportCompleted:"‚úì Export completed!",jsonExportCompleted:"‚úì JSON export completed!",htmlExportCompleted:"‚úì HTML export completed!",markdownExportCompleted:"‚úì Markdown export completed!",exportFailed:"‚úó Export failed: ",loadingPosts:"Loading posts...",topicID:"Topic ID",posts:"Posts",source:"Source",replyTo:"Reply to",exportedFrom:"Exported from Linux.do on",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"No posts found on this page",exportError:"An error occurred during export",scriptInitialized:"Linux.do Forum Exporter initialized",togglePanel:"Toggle panel",searchPlaceholder:"Search posts...",noResults:"No matching posts found",showAll:"Show all",lightTheme:"Light",darkTheme:"Dark",autoTheme:"Auto",theme:"Theme",includeComments:"Include comments",loadingComments:"Loading all comments...",commentsLoaded:"Loaded {count} comments",comments:"Comments",views:"Views",likes:"Likes",participants:"Participants"},"zh-CN":{exportJSON:"ÂØºÂá∫ JSON",exportHTML:"ÂØºÂá∫ HTML",exportMarkdown:"ÂØºÂá∫ Markdown",embedImages:"ÂµåÂÖ•ÂõæÁâá",language:"ËØ≠Ë®Ä",convertingImages:"Ê≠£Âú®ËΩ¨Êç¢ÂõæÁâá‰∏∫ base64...",convertingImagesJSON:"Ê≠£Âú®‰∏∫ JSON ÂØºÂá∫ËΩ¨Êç¢ÂõæÁâá...",convertingImagesMarkdown:"Ê≠£Âú®‰∏∫ Markdown ÂØºÂá∫ËΩ¨Êç¢ÂõæÁâá...",exportingJSON:"Ê≠£Âú®ÂØºÂá∫‰∏∫ JSON...",exportingHTML:"Ê≠£Âú®ÂØºÂá∫‰∏∫ HTML...",exportingMarkdown:"Ê≠£Âú®ÂØºÂá∫‰∏∫ Markdown...",exportCompleted:"‚úì ÂØºÂá∫ÂÆåÊàêÔºÅ",jsonExportCompleted:"‚úì JSON ÂØºÂá∫ÂÆåÊàêÔºÅ",htmlExportCompleted:"‚úì HTML ÂØºÂá∫ÂÆåÊàêÔºÅ",markdownExportCompleted:"‚úì Markdown ÂØºÂá∫ÂÆåÊàêÔºÅ",exportFailed:"‚úó ÂØºÂá∫Â§±Ë¥•Ôºö",loadingPosts:"Ê≠£Âú®Âä†ËΩΩÂ∏ñÂ≠ê...",topicID:"‰∏ªÈ¢ò ID",posts:"Â∏ñÂ≠êÊï∞",source:"Êù•Ê∫ê",replyTo:"ÂõûÂ§ç",exportedFrom:"ÂØºÂá∫Ëá™ Linux.do ‰∫é",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"È°µÈù¢Êú™ÊâæÂà∞Â∏ñÂ≠ê",exportError:"ÂØºÂá∫ËøáÁ®ã‰∏≠ÂèëÁîüÈîôËØØ",scriptInitialized:"Linux.do ËÆ∫ÂùõÂØºÂá∫Âô®Â∑≤ÂàùÂßãÂåñ",togglePanel:"Â±ïÂºÄ/Êî∂Ëµ∑",searchPlaceholder:"ÊêúÁ¥¢Â∏ñÂ≠ê...",noResults:"Êú™ÊâæÂà∞ÂåπÈÖçÁöÑÂ∏ñÂ≠ê",showAll:"ÊòæÁ§∫ÂÖ®ÈÉ®",lightTheme:"ÊµÖËâ≤",darkTheme:"Ê∑±Ëâ≤",autoTheme:"Ëá™Âä®",theme:"‰∏ªÈ¢ò",includeComments:"ÂåÖÂê´ËØÑËÆ∫",loadingComments:"Ê≠£Âú®Âä†ËΩΩÊâÄÊúâËØÑËÆ∫...",commentsLoaded:"Â∑≤Âä†ËΩΩ {count} Êù°ËØÑËÆ∫",comments:"ËØÑËÆ∫",views:"ÊµèËßà",likes:"ÁÇπËµû",participants:"ÂèÇ‰∏éËÄÖ"},"zh-TW":{exportJSON:"ÂåØÂá∫ JSON",exportHTML:"ÂåØÂá∫ HTML",exportMarkdown:"ÂåØÂá∫ Markdown",embedImages:"ÂµåÂÖ•ÂúñÁâá",language:"Ë™ûË®Ä",convertingImages:"Ê≠£Âú®ËΩâÊèõÂúñÁâáÁÇ∫ base64...",convertingImagesJSON:"Ê≠£Âú®ÁÇ∫ JSON ÂåØÂá∫ËΩâÊèõÂúñÁâá...",convertingImagesMarkdown:"Ê≠£Âú®ÁÇ∫ Markdown ÂåØÂá∫ËΩâÊèõÂúñÁâá...",exportingJSON:"Ê≠£Âú®ÂåØÂá∫ÁÇ∫ JSON...",exportingHTML:"Ê≠£Âú®ÂåØÂá∫ÁÇ∫ HTML...",exportingMarkdown:"Ê≠£Âú®ÂåØÂá∫ÁÇ∫ Markdown...",exportCompleted:"‚úì ÂåØÂá∫ÂÆåÊàêÔºÅ",jsonExportCompleted:"‚úì JSON ÂåØÂá∫ÂÆåÊàêÔºÅ",htmlExportCompleted:"‚úì HTML ÂåØÂá∫ÂÆåÊàêÔºÅ",markdownExportCompleted:"‚úì Markdown ÂåØÂá∫ÂÆåÊàêÔºÅ",exportFailed:"‚úó ÂåØÂá∫Â§±ÊïóÔºö",loadingPosts:"Ê≠£Âú®ËºâÂÖ•Ë≤ºÊñá...",topicID:"‰∏ªÈ°å ID",posts:"Ë≤ºÊñáÊï∏",source:"‰æÜÊ∫ê",replyTo:"ÂõûË¶Ü",exportedFrom:"ÂåØÂá∫Ëá™ Linux.do Êñº",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"È†ÅÈù¢Êú™ÊâæÂà∞Ë≤ºÊñá",exportError:"ÂåØÂá∫ÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§",scriptInitialized:"Linux.do Ë´ñÂ£áÂåØÂá∫Âô®Â∑≤ÂàùÂßãÂåñ",togglePanel:"Â±ïÈñã/Êî∂Ëµ∑",searchPlaceholder:"ÊêúÂ∞ãË≤ºÊñá...",noResults:"Êú™ÊâæÂà∞ÂåπÈÖçÁöÑË≤ºÊñá",showAll:"È°ØÁ§∫ÂÖ®ÈÉ®",lightTheme:"Ê∑∫Ëâ≤",darkTheme:"Ê∑±Ëâ≤",autoTheme:"Ëá™Âãï",theme:"‰∏ªÈ°å",includeComments:"ÂåÖÂê´Ë©ïË´ñ",loadingComments:"Ê≠£Âú®ËºâÂÖ•ÊâÄÊúâË©ïË´ñ...",commentsLoaded:"Â∑≤ËºâÂÖ• {count} ÂâáË©ïË´ñ",comments:"Ë©ïË´ñ",views:"ÁÄèË¶Ω",likes:"Ë¥ä",participants:"ÂèÉËàáËÄÖ"},ja:{exportJSON:"JSON „Ç®„ÇØ„Çπ„Éù„Éº„Éà",exportHTML:"HTML „Ç®„ÇØ„Çπ„Éù„Éº„Éà",exportMarkdown:"Markdown „Ç®„ÇØ„Çπ„Éù„Éº„Éà",embedImages:"ÁîªÂÉè„ÇíÂüã„ÇÅËæº„ÇÄ",language:"Ë®ÄË™û",convertingImages:"ÁîªÂÉè„Çí base64 „Å´Â§âÊèõ‰∏≠...",convertingImagesJSON:"JSON „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÁî®„Å´ÁîªÂÉè„ÇíÂ§âÊèõ‰∏≠...",convertingImagesMarkdown:"Markdown „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÁî®„Å´ÁîªÂÉè„ÇíÂ§âÊèõ‰∏≠...",exportingJSON:"JSON „Å´„Ç®„ÇØ„Çπ„Éù„Éº„Éà‰∏≠...",exportingHTML:"HTML „Å´„Ç®„ÇØ„Çπ„Éù„Éº„Éà‰∏≠...",exportingMarkdown:"Markdown „Å´„Ç®„ÇØ„Çπ„Éù„Éº„Éà‰∏≠...",exportCompleted:"‚úì „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÂÆå‰∫ÜÔºÅ",jsonExportCompleted:"‚úì JSON „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÂÆå‰∫ÜÔºÅ",htmlExportCompleted:"‚úì HTML „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÂÆå‰∫ÜÔºÅ",markdownExportCompleted:"‚úì Markdown „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÂÆå‰∫ÜÔºÅ",exportFailed:"‚úó „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÂ§±ÊïóÔºö",loadingPosts:"ÊäïÁ®ø„ÇíË™≠„ÅøËæº„Åø‰∏≠...",topicID:"„Éà„Éî„ÉÉ„ÇØ ID",posts:"ÊäïÁ®øÊï∞",source:"„ÇΩ„Éº„Çπ",replyTo:"Ëøî‰ø°ÂÖà",exportedFrom:"Linux.do „Åã„Çâ„Ç®„ÇØ„Çπ„Éù„Éº„Éà",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"„Åì„ÅÆ„Éö„Éº„Ç∏„Å´ÊäïÁ®ø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì",exportError:"„Ç®„ÇØ„Çπ„Éù„Éº„Éà‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü",scriptInitialized:"Linux.do „Éï„Ç©„Éº„É©„É†„Ç®„ÇØ„Çπ„Éù„Éº„Çø„Éº„ÅåÂàùÊúüÂåñ„Åï„Çå„Åæ„Åó„Åü",togglePanel:"ÈñãÈñâ",searchPlaceholder:"ÊäïÁ®ø„ÇíÊ§úÁ¥¢...",noResults:"‰∏ÄËá¥„Åô„ÇãÊäïÁ®ø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì",showAll:"„Åô„Åπ„Å¶Ë°®Á§∫",lightTheme:"„É©„Ç§„Éà",darkTheme:"„ÉÄ„Éº„ÇØ",autoTheme:"Ëá™Âãï",theme:"„ÉÜ„Éº„Éû",includeComments:"„Ç≥„É°„É≥„Éà„ÇíÂê´„ÇÅ„Çã",loadingComments:"„Åô„Åπ„Å¶„ÅÆ„Ç≥„É°„É≥„Éà„ÇíË™≠„ÅøËæº„Åø‰∏≠...",commentsLoaded:"{count}‰ª∂„ÅÆ„Ç≥„É°„É≥„Éà„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü",comments:"„Ç≥„É°„É≥„Éà",views:"Èñ≤Ë¶ß",likes:"„ÅÑ„ÅÑ„Å≠",participants:"ÂèÇÂä†ËÄÖ"},ko:{exportJSON:"JSON ÎÇ¥Î≥¥ÎÇ¥Í∏∞",exportHTML:"HTML ÎÇ¥Î≥¥ÎÇ¥Í∏∞",exportMarkdown:"Markdown ÎÇ¥Î≥¥ÎÇ¥Í∏∞",embedImages:"Ïù¥ÎØ∏ÏßÄ Ìè¨Ìï®",language:"Ïñ∏Ïñ¥",convertingImages:"Ïù¥ÎØ∏ÏßÄÎ•º base64Î°ú Î≥ÄÌôò Ï§ë...",convertingImagesJSON:"JSON ÎÇ¥Î≥¥ÎÇ¥Í∏∞Î•º ÏúÑÌï¥ Ïù¥ÎØ∏ÏßÄ Î≥ÄÌôò Ï§ë...",convertingImagesMarkdown:"Markdown ÎÇ¥Î≥¥ÎÇ¥Í∏∞Î•º ÏúÑÌï¥ Ïù¥ÎØ∏ÏßÄ Î≥ÄÌôò Ï§ë...",exportingJSON:"JSONÏúºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Îäî Ï§ë...",exportingHTML:"HTMLÎ°ú ÎÇ¥Î≥¥ÎÇ¥Îäî Ï§ë...",exportingMarkdown:"MarkdownÏúºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Îäî Ï§ë...",exportCompleted:"‚úì ÎÇ¥Î≥¥ÎÇ¥Í∏∞ ÏôÑÎ£å!",jsonExportCompleted:"‚úì JSON ÎÇ¥Î≥¥ÎÇ¥Í∏∞ ÏôÑÎ£å!",htmlExportCompleted:"‚úì HTML ÎÇ¥Î≥¥ÎÇ¥Í∏∞ ÏôÑÎ£å!",markdownExportCompleted:"‚úì Markdown ÎÇ¥Î≥¥ÎÇ¥Í∏∞ ÏôÑÎ£å!",exportFailed:"‚úó ÎÇ¥Î≥¥ÎÇ¥Í∏∞ Ïã§Ìå®: ",loadingPosts:"Í≤åÏãúÎ¨º Î°úÎî© Ï§ë...",topicID:"Ï£ºÏ†ú ID",posts:"Í≤åÏãúÎ¨º",source:"Ï∂úÏ≤ò",replyTo:"ÎãµÍ∏Ä",exportedFrom:"Linux.doÏóêÏÑú ÎÇ¥Î≥¥ÎÉÑ",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"Ïù¥ ÌéòÏù¥ÏßÄÏóêÏÑú Í≤åÏãúÎ¨ºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§",exportError:"ÎÇ¥Î≥¥ÎÇ¥Í∏∞ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§",scriptInitialized:"Linux.do Ìè¨Îüº ÎÇ¥Î≥¥ÎÇ¥Í∏∞ ÎèÑÍµ¨Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§",togglePanel:"Ìå®ÎÑê Ï†ÑÌôò",searchPlaceholder:"Í≤åÏãúÎ¨º Í≤ÄÏÉâ...",noResults:"ÏùºÏπòÌïòÎäî Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§",showAll:"Ï†ÑÏ≤¥ Î≥¥Í∏∞",lightTheme:"ÎùºÏù¥Ìä∏",darkTheme:"Îã§ÌÅ¨",autoTheme:"ÏûêÎèô",theme:"ÌÖåÎßà",includeComments:"ÎåìÍ∏Ä Ìè¨Ìï®",loadingComments:"Î™®Îì† ÎåìÍ∏Ä Î°úÎî© Ï§ë...",commentsLoaded:"{count}Í∞úÏùò ÎåìÍ∏ÄÏùÑ Î°úÎìúÌñàÏäµÎãàÎã§",comments:"ÎåìÍ∏Ä",views:"Ï°∞ÌöåÏàò",likes:"Ï¢ãÏïÑÏöî",participants:"Ï∞∏Ïó¨Ïûê"},es:{exportJSON:"Exportar JSON",exportHTML:"Exportar HTML",exportMarkdown:"Exportar Markdown",embedImages:"Incluir im√°genes",language:"Idioma",convertingImages:"Convirtiendo im√°genes a base64...",convertingImagesJSON:"Convirtiendo im√°genes para exportaci√≥n JSON...",convertingImagesMarkdown:"Convirtiendo im√°genes para exportaci√≥n Markdown...",exportingJSON:"Exportando a JSON...",exportingHTML:"Exportando a HTML...",exportingMarkdown:"Exportando a Markdown...",exportCompleted:"‚úì ¬°Exportaci√≥n completada!",jsonExportCompleted:"‚úì ¬°Exportaci√≥n JSON completada!",htmlExportCompleted:"‚úì ¬°Exportaci√≥n HTML completada!",markdownExportCompleted:"‚úì ¬°Exportaci√≥n Markdown completada!",exportFailed:"‚úó Error en la exportaci√≥n: ",loadingPosts:"Cargando publicaciones...",topicID:"ID del tema",posts:"Publicaciones",source:"Fuente",replyTo:"Responder a",exportedFrom:"Exportado de Linux.do el",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"No se encontraron publicaciones en esta p√°gina",exportError:"Ocurri√≥ un error durante la exportaci√≥n",scriptInitialized:"Exportador de foros Linux.do inicializado",togglePanel:"Alternar panel",searchPlaceholder:"Buscar publicaciones...",noResults:"No se encontraron publicaciones",showAll:"Mostrar todo",lightTheme:"Claro",darkTheme:"Oscuro",autoTheme:"Auto",theme:"Tema",includeComments:"Incluir comentarios",loadingComments:"Cargando todos los comentarios...",commentsLoaded:"Se cargaron {count} comentarios",comments:"Comentarios",views:"Vistas",likes:"Me gusta",participants:"Participantes"},fr:{exportJSON:"Exporter JSON",exportHTML:"Exporter HTML",exportMarkdown:"Exporter Markdown",embedImages:"Int√©grer les images",language:"Langue",convertingImages:"Conversion des images en base64...",convertingImagesJSON:"Conversion des images pour l'export JSON...",convertingImagesMarkdown:"Conversion des images pour l'export Markdown...",exportingJSON:"Exportation en JSON...",exportingHTML:"Exportation en HTML...",exportingMarkdown:"Exportation en Markdown...",exportCompleted:"‚úì Exportation termin√©e !",jsonExportCompleted:"‚úì Exportation JSON termin√©e !",htmlExportCompleted:"‚úì Exportation HTML termin√©e !",markdownExportCompleted:"‚úì Exportation Markdown termin√©e !",exportFailed:"‚úó √âchec de l'exportation : ",loadingPosts:"Chargement des publications...",topicID:"ID du sujet",posts:"Publications",source:"Source",replyTo:"R√©pondre √†",exportedFrom:"Export√© de Linux.do le",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"Aucune publication trouv√©e sur cette page",exportError:"Une erreur s'est produite lors de l'exportation",scriptInitialized:"Exportateur de forum Linux.do initialis√©",togglePanel:"Basculer le panneau",searchPlaceholder:"Rechercher des publications...",noResults:"Aucune publication trouv√©e",showAll:"Tout afficher",lightTheme:"Clair",darkTheme:"Sombre",autoTheme:"Auto",theme:"Th√®me",includeComments:"Inclure les commentaires",loadingComments:"Chargement de tous les commentaires...",commentsLoaded:"{count} commentaires charg√©s",comments:"Commentaires",views:"Vues",likes:"J'aime",participants:"Participants"},de:{exportJSON:"JSON exportieren",exportHTML:"HTML exportieren",exportMarkdown:"Markdown exportieren",embedImages:"Bilder einbetten",language:"Sprache",convertingImages:"Konvertiere Bilder zu base64...",convertingImagesJSON:"Konvertiere Bilder f√ºr JSON-Export...",convertingImagesMarkdown:"Konvertiere Bilder f√ºr Markdown-Export...",exportingJSON:"Exportiere zu JSON...",exportingHTML:"Exportiere zu HTML...",exportingMarkdown:"Exportiere zu Markdown...",exportCompleted:"‚úì Export abgeschlossen!",jsonExportCompleted:"‚úì JSON-Export abgeschlossen!",htmlExportCompleted:"‚úì HTML-Export abgeschlossen!",markdownExportCompleted:"‚úì Markdown-Export abgeschlossen!",exportFailed:"‚úó Export fehlgeschlagen: ",loadingPosts:"Lade Beitr√§ge...",topicID:"Themen-ID",posts:"Beitr√§ge",source:"Quelle",replyTo:"Antworten an",exportedFrom:"Exportiert von Linux.do am",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"Keine Beitr√§ge auf dieser Seite gefunden",exportError:"Ein Fehler ist beim Export aufgetreten",scriptInitialized:"Linux.do Forum-Exporter initialisiert",togglePanel:"Panel umschalten",searchPlaceholder:"Beitr√§ge suchen...",noResults:"Keine passenden Beitr√§ge gefunden",showAll:"Alle anzeigen",lightTheme:"Hell",darkTheme:"Dunkel",autoTheme:"Auto",theme:"Design",includeComments:"Kommentare einschlie√üen",loadingComments:"Alle Kommentare werden geladen...",commentsLoaded:"{count} Kommentare geladen",comments:"Kommentare",views:"Aufrufe",likes:"Gef√§llt mir",participants:"Teilnehmer"},ru:{exportJSON:"–≠–∫—Å–ø–æ—Ä—Ç JSON",exportHTML:"–≠–∫—Å–ø–æ—Ä—Ç HTML",exportMarkdown:"–≠–∫—Å–ø–æ—Ä—Ç Markdown",embedImages:"–í—Å—Ç—Ä–æ–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è",language:"–Ø–∑—ã–∫",convertingImages:"–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ base64...",convertingImagesJSON:"–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ JSON...",convertingImagesMarkdown:"–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ Markdown...",exportingJSON:"–≠–∫—Å–ø–æ—Ä—Ç –≤ JSON...",exportingHTML:"–≠–∫—Å–ø–æ—Ä—Ç –≤ HTML...",exportingMarkdown:"–≠–∫—Å–ø–æ—Ä—Ç –≤ Markdown...",exportCompleted:"‚úì –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!",jsonExportCompleted:"‚úì –≠–∫—Å–ø–æ—Ä—Ç JSON –∑–∞–≤–µ—Ä—à–µ–Ω!",htmlExportCompleted:"‚úì –≠–∫—Å–ø–æ—Ä—Ç HTML –∑–∞–≤–µ—Ä—à–µ–Ω!",markdownExportCompleted:"‚úì –≠–∫—Å–ø–æ—Ä—Ç Markdown –∑–∞–≤–µ—Ä—à–µ–Ω!",exportFailed:"‚úó –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ",loadingPosts:"–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...",topicID:"ID —Ç–µ–º—ã",posts:"–°–æ–æ–±—â–µ–Ω–∏—è",source:"–ò—Å—Ç–æ—á–Ω–∏–∫",replyTo:"–û—Ç–≤–µ—Ç–∏—Ç—å",exportedFrom:"–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Å Linux.do",dateFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},noPostsFound:"–ù–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π",exportError:"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ",scriptInitialized:"–≠–∫—Å–ø–æ—Ä—Ç–µ—Ä —Ñ–æ—Ä—É–º–∞ Linux.do –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω",togglePanel:"–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ø–∞–Ω–µ–ª—å",searchPlaceholder:"–ü–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π...",noResults:"–°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",showAll:"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ",lightTheme:"–°–≤–µ—Ç–ª–∞—è",darkTheme:"–¢—ë–º–Ω–∞—è",autoTheme:"–ê–≤—Ç–æ",theme:"–¢–µ–º–∞",includeComments:"–í–∫–ª—é—á–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",loadingComments:"–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤...",commentsLoaded:"–ó–∞–≥—Ä—É–∂–µ–Ω–æ {count} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤",comments:"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",views:"–ü—Ä–æ—Å–º–æ—Ç—Ä—ã",likes:"–õ–∞–π–∫–∏",participants:"–£—á–∞—Å—Ç–Ω–∏–∫–∏"}},t={en:"English","zh-CN":"ÁÆÄ‰Ωì‰∏≠Êñá","zh-TW":"ÁπÅÈ´î‰∏≠Êñá",ja:"Êó•Êú¨Ë™û",ko:"ÌïúÍµ≠Ïñ¥",es:"Espa√±ol",fr:"Fran√ßais",de:"Deutsch",ru:"–†—É—Å—Å–∫–∏–π"},n=new class{constructor(){this.currentLang=this.detectLanguage(),this.fallbackLang="en"}detectLanguage(){const t="undefined"!=typeof GM_getValue?GM_getValue("language",null):localStorage.getItem("exporter_language");if(t&&e[t])return t;const n=navigator.language||navigator.userLanguage;if(e[n])return n;const o=n.split("-")[0];return Object.keys(e).find(e=>e.startsWith(o))||this.fallbackLang}setLanguage(t){return!!e[t]&&(this.currentLang=t,"undefined"!=typeof GM_setValue?GM_setValue("language",t):localStorage.setItem("exporter_language",t),!0)}t(t){const n=t.split(".");let o=e[this.currentLang];for(const r of n){if(!o||"object"!=typeof o||!(r in o)){o=e[this.fallbackLang];for(const e of n){if(!o||"object"!=typeof o||!(e in o))return t;o=o[e]}break}o=o[r]}return o}getAvailableLanguages(){return Object.keys(e).map(e=>({code:e,name:this.getLanguageName(e)}))}getLanguageName(e){return t[e]||e}formatDate(e){return new Date(e).toLocaleString(this.currentLang,this.t("dateFormat"))}};async function o(e,t=!1){const n=new Map,o=.8*window.innerHeight;let a=-1,s=0;for(window.scrollTo(0,0),await new Promise(e=>setTimeout(e,300));s<10;){const p=document.querySelectorAll(".topic-post");for(const e of p){const o=e.getAttribute("data-post-number");if(!o)continue;const a=parseInt(o);if(!(a<=1||n.has(a))){const o=r(e);if(o){if(t){if(o.author.avatarUrl){const e=o.author.avatarUrl.startsWith("http")?o.author.avatarUrl:`https://linux.do${o.author.avatarUrl}`;o.author.avatarUrl=await i(e)}o.content=await l(o.content);for(const e of o.quotes)e.content=await l(e.content)}n.set(a,o)}}}e&&e(n.size),window.scrollBy(0,o),await new Promise(e=>setTimeout(e,300));const c=window.scrollY;c===a?s++:(s=0,a=c),window.scrollY+window.innerHeight>=document.body.scrollHeight-100&&(await new Promise(e=>setTimeout(e,600)),window.scrollY+window.innerHeight>=document.body.scrollHeight-100&&(s=10))}return window.scrollTo(0,0),n}function r(e){const t=e.getAttribute("data-post-number");if(!t)return null;const n=t,o=e.querySelector("article[data-post-id]");if(!o)return null;const r=o.getAttribute("data-post-id"),a=o.getAttribute("data-user-id"),i=o.querySelector(".names a"),s=i?i.textContent.trim():"",p=i?i.getAttribute("href"):"",l=o.querySelector(".user-title"),c=l?l.textContent.trim():"",d=o.querySelector(".post-avatar img.avatar"),m=d?d.getAttribute("src"):"",u=o.querySelector(".post-date .relative-date"),g=u?u.getAttribute("data-time"):"",x=u?u.getAttribute("title"):"",h=u?u.textContent.trim():"",b=o.querySelector(".cooked"),v=b?b.innerHTML:"",f=b?b.textContent.trim():"",y=[];return o.querySelectorAll("aside.quote").forEach(e=>{const t=e.getAttribute("data-username"),n=e.getAttribute("data-post"),o=e.getAttribute("data-topic"),r=e.querySelector("blockquote");y.push({username:t,postNumber:n,topicId:o,content:r?r.innerHTML:""})}),{postId:r,postNumber:parseInt(n),userId:a,author:{username:s,profileUrl:p,avatarUrl:m,title:c},timestamp:g,dateTitle:x,dateFormatted:h,content:v,contentText:f,quotes:y}}async function a(e=!1){const t=document.querySelector(".topic-map");if(!t)return null;const n={},o=t.querySelector(".topic-map__views-trigger");if(o){const e=o.querySelector(".number");n.views=e?parseInt(e.textContent.trim()):0}const r=t.querySelector(".topic-map__likes-trigger");if(r){const e=r.querySelector(".number");n.likes=e?parseInt(e.textContent.trim()):0}const a=t.querySelector(".topic-map__links-trigger");if(a){const e=a.querySelector(".number");n.links=e?parseInt(e.textContent.trim()):0}const s=t.querySelector(".topic-map__users-trigger");if(s){const e=s.querySelector(".number");n.userCount=e?parseInt(e.textContent.trim()):0}const p=[],l=t.querySelectorAll(".topic-map__users-list .poster");for(const t of l){const n=t.getAttribute("data-user-card")||t.getAttribute("title")||"",o=t.querySelector("img.avatar");let r=o?o.getAttribute("src"):"";const a=t.querySelector(".post-count"),s=a?parseInt(a.textContent.trim()):1,l=o?o.getAttribute("title"):n;if(e&&r){const e=r.startsWith("http")?r:`https://linux.do${r}`;r=await i(e)}p.push({username:n,displayName:l,avatarUrl:r,postCount:s})}return n.participants=p,n}async function i(e){try{const t=await fetch(e),n=await t.blob();return new Promise((e,t)=>{const o=new FileReader;o.onloadend=()=>e(o.result),o.onerror=t,o.readAsDataURL(n)})}catch(t){return console.error("Failed to convert image:",e,t),e}}function s(e){const t=e.getAttribute("data-post-id"),n=e.closest(".topic-post"),o=n?n.getAttribute("data-post-number"):"1",r=e.querySelector(".names a"),a=r?r.textContent.trim():"",i=r?r.getAttribute("href"):"",s=e.querySelector(".post-avatar img"),p=s?s.getAttribute("src"):"",l=e.querySelector(".post-date .relative-date"),c=l?l.getAttribute("data-time"):"",d=l?l.textContent.trim():"",m=e.querySelector(".cooked"),u=m?m.innerHTML:"",g=m?m.textContent.trim():"",x=[];e.querySelectorAll("aside.quote").forEach(e=>{const t=e.getAttribute("data-username"),n=e.getAttribute("data-post"),o=e.querySelector("blockquote");x.push({username:t,postNumber:n,content:o?o.innerHTML:""})});const h=e.querySelector(".reply-to-tab");let b=null;if(h){const e=h.querySelector("span"),t=h.querySelector("img");b={username:e?e.textContent.trim():"",avatarUrl:t?t.getAttribute("src"):""}}const v=[];return e.querySelectorAll(".discourse-reactions-counter button").forEach(e=>{const t=e.querySelector(".count"),n=e.querySelector(".emoji");t&&n&&v.push({emoji:n.textContent.trim(),count:parseInt(t.textContent.trim())})}),{postId:t,postNumber:parseInt(o),author:{username:a,profileUrl:i,avatarUrl:p},timestamp:c,dateFormatted:d,content:u,contentText:g,quotes:x,replyTo:b,reactions:v}}function p(){const e=document.querySelector("h1[data-topic-id] .fancy-title span"),t=document.querySelector("h1[data-topic-id]")?.getAttribute("data-topic-id"),n=document.querySelector(".badge-category__name"),o=[...new Set(Array.from(document.querySelectorAll(".discourse-tag")).map(e=>e.textContent.trim()))];return{topicId:t,title:e?e.textContent.trim():"",category:n?n.textContent.trim():"",tags:o,url:window.location.href}}async function l(e){const t=document.createElement("div");t.innerHTML=e;const n=t.querySelectorAll("img");for(const e of n){const t=e.getAttribute("src");if(t){const n=t.startsWith("http")?t:`https://linux.do${t}`,o=await i(n);e.setAttribute("src",o)}}return t.innerHTML}function c(e){const t=document.createElement("div");return t.innerHTML=e,[".cooked-selection-barrier","div:empty",'[aria-hidden="true"]'].forEach(e=>{t.querySelectorAll(e).forEach(e=>e.remove())}),t.innerHTML.replace(/\s*<br>\s*<\/div>/g,"</div>").replace(/<div>\s*<\/div>/g,"").replace(/\n\s*\n/g,"\n").trim()}async function d(e=!1){const t=document.querySelectorAll(".topic-post"),o=[],r=new Set;for(const n of t){const t=parseInt(n.getAttribute("data-post-number"));if(1!==t||r.has(t))continue;r.add(t);const a=n.querySelector("article[data-post-id]");if(!a)continue;const p=s(a);if(e){if(p.author.avatarUrl){const e=p.author.avatarUrl.startsWith("http")?p.author.avatarUrl:`https://linux.do${p.author.avatarUrl}`;p.author.avatarUrl=await i(e)}p.content=await l(p.content);for(const e of p.quotes)e.content=await l(e.content);if(p.replyTo&&p.replyTo.avatarUrl){const e=p.replyTo.avatarUrl.startsWith("http")?p.replyTo.avatarUrl:`https://linux.do${p.replyTo.avatarUrl}`;p.replyTo.avatarUrl=await i(e)}}o.push(p)}return{topic:p(),posts:o,exportDate:(new Date).toISOString(),postCount:o.length,language:n.currentLang}}function m(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}function u(e){if(!e)return"";let t=e;return t=t.replace(/<pre[^>]*>\s*<code[^>]*class="[^"]*lang-([^"\s]+)[^"]*"[^>]*>([\s\S]*?)<\/code>\s*<\/pre>/gi,(e,t,n)=>`\n\n\`\`\`${t}\n${g(n.trim())}\n\`\`\`\n\n`),t=t.replace(/<pre[^>]*>\s*<code[^>]*>([\s\S]*?)<\/code>\s*<\/pre>/gi,(e,t)=>`\n\n\`\`\`\n${g(t.trim())}\n\`\`\`\n\n`),t=t.replace(/<pre[^>]*>([\s\S]*?)<\/pre>/gi,(e,t)=>`\n\n\`\`\`\n${g(t.trim())}\n\`\`\`\n\n`),t=t.replace(/<code[^>]*>([^<]*)<\/code>/gi,"`$1`"),t=t.replace(/<h1[^>]*>([\s\S]*?)<\/h1>/gi,"\n# $1\n"),t=t.replace(/<h2[^>]*>([\s\S]*?)<\/h2>/gi,"\n## $1\n"),t=t.replace(/<h3[^>]*>([\s\S]*?)<\/h3>/gi,"\n### $1\n"),t=t.replace(/<h4[^>]*>([\s\S]*?)<\/h4>/gi,"\n#### $1\n"),t=t.replace(/<h5[^>]*>([\s\S]*?)<\/h5>/gi,"\n##### $1\n"),t=t.replace(/<h6[^>]*>([\s\S]*?)<\/h6>/gi,"\n###### $1\n"),t=t.replace(/<strong[^>]*>([\s\S]*?)<\/strong>/gi,"**$1**"),t=t.replace(/<b[^>]*>([\s\S]*?)<\/b>/gi,"**$1**"),t=t.replace(/<em[^>]*>([\s\S]*?)<\/em>/gi,"*$1*"),t=t.replace(/<i[^>]*>([\s\S]*?)<\/i>/gi,"*$1*"),t=t.replace(/<del[^>]*>([\s\S]*?)<\/del>/gi,"~~$1~~"),t=t.replace(/<s[^>]*>([\s\S]*?)<\/s>/gi,"~~$1~~"),t=t.replace(/<strike[^>]*>([\s\S]*?)<\/strike>/gi,"~~$1~~"),t=t.replace(/<a[^>]*href="([^"]*)"[^>]*>([\s\S]*?)<\/a>/gi,"[$2]($1)"),t=t.replace(/<img[^>]*src="([^"]*)"[^>]*alt="([^"]*)"[^>]*\/?>/gi,"![$2]($1)"),t=t.replace(/<img[^>]*alt="([^"]*)"[^>]*src="([^"]*)"[^>]*\/?>/gi,"![$1]($2)"),t=t.replace(/<img[^>]*src="([^"]*)"[^>]*\/?>/gi,"![]($1)"),t=t.replace(/<blockquote[^>]*>([\s\S]*?)<\/blockquote>/gi,(e,t)=>"\n"+t.trim().split("\n").map(e=>`> ${e.trim()}`).join("\n")+"\n"),t=t.replace(/<ul[^>]*>([\s\S]*?)<\/ul>/gi,(e,t)=>"\n"+t.replace(/<li[^>]*>([\s\S]*?)<\/li>/gi,"- $1\n")+"\n"),t=t.replace(/<ol[^>]*>([\s\S]*?)<\/ol>/gi,(e,t)=>{let n=1;return"\n"+t.replace(/<li[^>]*>([\s\S]*?)<\/li>/gi,()=>n+++". $1\n").replace(/\$1/g,(e,n,o)=>{const r=t.match(/<li[^>]*>([\s\S]*?)<\/li>/gi);if(r){const e=Math.floor(n/10);if(r[e])return r[e].replace(/<li[^>]*>([\s\S]*?)<\/li>/i,"$1")}return""})+"\n"}),t=t.replace(/<ol[^>]*>([\s\S]*?)<\/ol>/gi,(e,t)=>{let n=1;return"\n"+t.replace(/<li[^>]*>([\s\S]*?)<\/li>/gi,(e,t)=>`${n++}. ${t.trim()}\n`)+"\n"}),t=t.replace(/<ul[^>]*>([\s\S]*?)<\/ul>/gi,(e,t)=>"\n"+t.replace(/<li[^>]*>([\s\S]*?)<\/li>/gi,(e,t)=>`- ${t.trim()}\n`)+"\n"),t=t.replace(/<hr[^>]*\/?>/gi,"\n---\n"),t=t.replace(/<br[^>]*\/?>/gi,"\n"),t=t.replace(/<p[^>]*>([\s\S]*?)<\/p>/gi,"\n$1\n"),t=t.replace(/<div[^>]*>([\s\S]*?)<\/div>/gi,"$1\n"),t=t.replace(/<span[^>]*>([\s\S]*?)<\/span>/gi,"$1"),t=t.replace(/<table[^>]*>([\s\S]*?)<\/table>/gi,(e,t)=>{let n="\n";const o=t.match(/<tr[^>]*>([\s\S]*?)<\/tr>/gi)||[];let r=!0;return o.forEach(e=>{const t=(e.match(/<t[hd][^>]*>([\s\S]*?)<\/t[hd]>/gi)||[]).map(e=>e.replace(/<t[hd][^>]*>([\s\S]*?)<\/t[hd]>/i,"$1").trim());t.length>0&&(n+="| "+t.join(" | ")+" |\n",r&&(n+="| "+t.map(()=>"---").join(" | ")+" |\n",r=!1))}),n+"\n"}),t=t.replace(/<aside[^>]*class="[^"]*quote[^"]*"[^>]*>([\s\S]*?)<\/aside>/gi,(e,t)=>{const n=t.match(/<blockquote[^>]*>([\s\S]*?)<\/blockquote>/i);return n?"\n"+n[1].trim().split("\n").map(e=>`> ${e.trim()}`).join("\n")+"\n":""}),t=t.replace(/<[^>]+>/g,""),t=g(t),t=t.replace(/\n{3,}/g,"\n\n"),t=t.trim(),t}function g(e){return e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t)).replace(/&#x([0-9a-fA-F]+);/g,(e,t)=>String.fromCharCode(parseInt(t,16))):""}function x(e,t,n){const o=new Blob([e],{type:n}),r=URL.createObjectURL(o),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}const h="linuxdo-export-panel-collapsed";function b(e){let t=document.getElementById("export-progress");t||(t=document.createElement("div"),t.id="export-progress",t.style.cssText='\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: #1a1a1a;\n      color: white;\n      padding: 12px 20px;\n      border-radius: 8px;\n      font-size: 13px;\n      z-index: 10000;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n      max-width: 300px;\n      animation: slideIn 0.3s ease-out;\n    ',document.body.appendChild(t)),t.textContent=e,t.style.display="block"}function v(){const e=document.getElementById("export-progress");e&&(e.style.opacity="0",e.style.transition="opacity 0.3s",setTimeout(()=>{e.style.display="none",e.style.opacity="1"},300))}function f(){const e=n.getAvailableLanguages(),t=n.currentLang,o=document.createElement("div");return o.className="language-selector",o.innerHTML=`\n    <select id="language-select">\n      ${e.map(e=>`\n        <option value="${e.code}" ${e.code===t?"selected":""}>\n          ${e.name}\n        </option>\n      `).join("")}\n    </select>\n  `,o.querySelector("#language-select").addEventListener("change",e=>{const t=e.target.value;n.setLanguage(t)&&(function(){const e=document.getElementById("export-json"),t=document.getElementById("export-html"),o=document.querySelector('label[for="embed-images"]'),r=document.getElementById("export-markdown");e&&(e.querySelector("span:last-child").textContent=n.t("exportJSON")),t&&(t.querySelector("span:last-child").textContent=n.t("exportHTML")),r&&(r.querySelector("span:last-child").textContent=n.t("exportMarkdown")),o&&(o.textContent=n.t("embedImages"))}(),b(n.t("scriptInitialized")),setTimeout(v,2e3))}),o}function y(){const e=document.createElement("div");e.id="export-button-container",e.innerHTML=`\n    <style>\n    @keyframes slideIn {\n      from { transform: translateX(100%); opacity: 0; }\n      to { transform: translateX(0); opacity: 1; }\n    }\n\n    @keyframes fadeIn {\n      from { opacity: 0; }\n      to { opacity: 1; }\n    }\n\n    /* Theme-adaptive CSS variables - Light theme default */\n    #export-controls {\n      --export-btn-bg: #1a1a1a;\n      --export-btn-bg-hover: #2d2d2d;\n      --export-btn-text: #ffffff;\n      --export-panel-bg: #ffffff;\n      --export-panel-text: #1a1a1a;\n      --export-panel-border: #e9ecef;\n      --export-panel-hover: #f8f9fa;\n      --export-shadow: rgba(0, 0, 0, 0.15);\n      --export-shadow-hover: rgba(0, 0, 0, 0.2);\n    }\n\n    /* Dark theme detection - Discourse/Linux.do uses various class names */\n    html.dark-theme #export-controls,\n    html.dark #export-controls,\n    html[data-color-scheme="dark"] #export-controls,\n    html[data-theme="dark"] #export-controls,\n    html.scheme-dark #export-controls,\n    body.dark-theme #export-controls,\n    body.dark #export-controls,\n    .dark-theme #export-controls,\n    .dark #export-controls,\n    #export-controls.dark-mode {\n      --export-btn-bg: #ffffff;\n      --export-btn-bg-hover: #f0f0f0;\n      --export-btn-text: #1a1a1a;\n      --export-panel-bg: #2d2d2d;\n      --export-panel-text: #e9ecef;\n      --export-panel-border: #404040;\n      --export-panel-hover: #3d3d3d;\n      --export-shadow: rgba(0, 0, 0, 0.3);\n      --export-shadow-hover: rgba(0, 0, 0, 0.4);\n    }\n\n    /* Fallback: prefers-color-scheme for system dark mode */\n    @media (prefers-color-scheme: dark) {\n      #export-controls:not(.light-forced) {\n        --export-btn-bg: #ffffff;\n        --export-btn-bg-hover: #f0f0f0;\n        --export-btn-text: #1a1a1a;\n        --export-panel-bg: #2d2d2d;\n        --export-panel-text: #e9ecef;\n        --export-panel-border: #404040;\n        --export-panel-hover: #3d3d3d;\n        --export-shadow: rgba(0, 0, 0, 0.3);\n        --export-shadow-hover: rgba(0, 0, 0, 0.4);\n      }\n    }\n\n    /* Override for explicit light theme on site */\n    html.light-theme #export-controls,\n    html.light #export-controls,\n    html[data-color-scheme="light"] #export-controls,\n    html[data-theme="light"] #export-controls,\n    html.scheme-light #export-controls {\n      --export-btn-bg: #1a1a1a;\n      --export-btn-bg-hover: #2d2d2d;\n      --export-btn-text: #ffffff;\n      --export-panel-bg: #ffffff;\n      --export-panel-text: #1a1a1a;\n      --export-panel-border: #e9ecef;\n      --export-panel-hover: #f8f9fa;\n      --export-shadow: rgba(0, 0, 0, 0.15);\n      --export-shadow-hover: rgba(0, 0, 0, 0.2);\n    }\n\n    #export-controls {\n      position: fixed;\n      bottom: 24px;\n      right: 24px;\n      z-index: 9999;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n    }\n\n    .export-btn {\n      background: var(--export-btn-bg);\n      color: var(--export-btn-text);\n      border: none;\n      padding: 12px 20px;\n      border-radius: 8px;\n      cursor: pointer;\n      font-size: 13px;\n      font-weight: 500;\n      box-shadow: 0 2px 8px var(--export-shadow);\n      transition: all 0.2s ease;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      white-space: nowrap;\n      min-width: 160px;\n      justify-content: center;\n    }\n\n    .export-btn:hover {\n      background: var(--export-btn-bg-hover);\n      box-shadow: 0 4px 12px var(--export-shadow-hover);\n      transform: translateY(-1px);\n    }\n\n    .export-btn:active {\n      transform: translateY(0);\n      box-shadow: 0 2px 6px var(--export-shadow);\n    }\n\n    .export-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }\n\n    .checkbox-wrapper {\n      background: var(--export-panel-bg);\n      padding: 10px 16px;\n      border-radius: 8px;\n      box-shadow: 0 2px 8px var(--export-shadow);\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      font-size: 13px;\n      color: var(--export-panel-text);\n      cursor: pointer;\n      transition: all 0.2s ease;\n      border: 1px solid var(--export-panel-border);\n    }\n\n    .checkbox-wrapper:hover { background: var(--export-panel-hover); box-shadow: 0 4px 12px var(--export-shadow-hover); }\n    .checkbox-wrapper input[type="checkbox"] { width: 16px; height: 16px; cursor: pointer; margin: 0; accent-color: var(--export-btn-bg); }\n    .checkbox-wrapper label { cursor: pointer; user-select: none; font-weight: 500; }\n\n    .language-selector {\n      background: var(--export-panel-bg);\n      padding: 8px 12px;\n      border-radius: 8px;\n      box-shadow: 0 2px 8px var(--export-shadow);\n      border: 1px solid var(--export-panel-border);\n    }\n\n    .language-selector select {\n      width: 100%;\n      border: none;\n      background: transparent;\n      font-size: 13px;\n      font-weight: 500;\n      color: var(--export-panel-text);\n      cursor: pointer;\n      outline: none;\n      font-family: inherit;\n    }\n\n    .language-selector select option {\n      background: var(--export-panel-bg);\n      color: var(--export-panel-text);\n    }\n\n    /* Toggle button - always visible */\n    .export-toggle-btn {\n      background: var(--export-btn-bg);\n      color: var(--export-btn-text);\n      border: none;\n      width: 48px;\n      height: 48px;\n      border-radius: 50%;\n      cursor: pointer;\n      font-size: 20px;\n      box-shadow: 0 2px 12px var(--export-shadow);\n      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      align-self: flex-end;\n    }\n\n    .export-toggle-btn:hover {\n      background: var(--export-btn-bg-hover);\n      box-shadow: 0 4px 16px var(--export-shadow-hover);\n      transform: scale(1.05);\n    }\n\n    .export-toggle-btn:active {\n      transform: scale(0.95);\n    }\n\n    .export-toggle-btn .icon {\n      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    }\n\n    #export-controls.collapsed .export-toggle-btn .icon {\n      transform: rotate(180deg);\n    }\n\n    /* Panel container */\n    .export-panel {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n      overflow: hidden;\n      transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);\n      max-height: 400px;\n      opacity: 1;\n      transform: translateY(0);\n    }\n\n    #export-controls.collapsed .export-panel {\n      max-height: 0;\n      opacity: 0;\n      transform: translateY(10px);\n      pointer-events: none;\n    }\n\n    /* Staggered animation for panel items */\n    .export-panel > * {\n      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n      transform: translateX(0);\n      opacity: 1;\n    }\n\n    #export-controls.collapsed .export-panel > * {\n      transform: translateX(20px);\n      opacity: 0;\n    }\n\n    .export-panel > *:nth-child(1) { transition-delay: 0.05s; }\n    .export-panel > *:nth-child(2) { transition-delay: 0.1s; }\n    .export-panel > *:nth-child(3) { transition-delay: 0.15s; }\n    .export-panel > *:nth-child(4) { transition-delay: 0.2s; }\n    .export-panel > *:nth-child(5) { transition-delay: 0.25s; }\n    .export-panel > *:nth-child(6) { transition-delay: 0.3s; }\n\n    #export-controls.collapsed .export-panel > *:nth-child(1) { transition-delay: 0.25s; }\n    #export-controls.collapsed .export-panel > *:nth-child(2) { transition-delay: 0.2s; }\n    #export-controls.collapsed .export-panel > *:nth-child(3) { transition-delay: 0.15s; }\n    #export-controls.collapsed .export-panel > *:nth-child(4) { transition-delay: 0.1s; }\n    #export-controls.collapsed .export-panel > *:nth-child(5) { transition-delay: 0.05s; }\n    #export-controls.collapsed .export-panel > *:nth-child(6) { transition-delay: 0s; }\n\n    @media (max-width: 768px) {\n      #export-controls { bottom: 16px; right: 16px; }\n      .export-btn { padding: 10px 16px; font-size: 12px; min-width: 140px; }\n      .checkbox-wrapper { padding: 8px 12px; font-size: 12px; }\n      .language-selector { padding: 6px 10px; }\n      .language-selector select { font-size: 12px; }\n      .export-toggle-btn { width: 44px; height: 44px; font-size: 18px; }\n    }\n  </style>\n    <div id="export-controls">\n      <div class="export-panel">\n        <button id="export-json" class="export-btn">\n          <span>üìÑ</span>\n          <span>${n.t("exportJSON")}</span>\n        </button>\n        <button id="export-html" class="export-btn">\n          <span>üåê</span>\n          <span>${n.t("exportHTML")}</span>\n        </button>\n        <button id="export-markdown" class="export-btn">\n          <span>üìù</span>\n          <span>${n.t("exportMarkdown")}</span>\n        </button>\n        <label class="checkbox-wrapper">\n          <input type="checkbox" id="embed-images" checked>\n          <label for="embed-images">${n.t("embedImages")}</label>\n        </label>\n        <label class="checkbox-wrapper">\n          <input type="checkbox" id="include-comments">\n          <label for="include-comments">${n.t("includeComments")}</label>\n        </label>\n      </div>\n      <button id="export-toggle" class="export-toggle-btn" title="${n.t("togglePanel")||"Â±ïÂºÄ/Êî∂Ëµ∑"}">\n        <span class="icon">üì§</span>\n      </button>\n    </div>\n  `,document.body.appendChild(e);const t=document.getElementById("export-controls");(function(){const e=document.documentElement,t=document.body;if(e.classList.contains("dark-theme")||e.classList.contains("dark")||"dark"===e.getAttribute("data-color-scheme")||"dark"===e.getAttribute("data-theme")||e.classList.contains("scheme-dark")||t.classList.contains("dark-theme")||t.classList.contains("dark"))return!0;const n=getComputedStyle(t).backgroundColor.match(/\d+/g);if(n){const[e,t,o]=n.map(Number);if((.299*e+.587*t+.114*o)/255<.5)return!0}return window.matchMedia("(prefers-color-scheme: dark)").matches})()&&t.classList.add("dark-mode"),function(){try{return"true"===localStorage.getItem(h)}catch{return!1}}()&&t.classList.add("collapsed"),document.getElementById("export-toggle").addEventListener("click",()=>{!function(e){try{localStorage.setItem(h,String(e))}catch{}}(t.classList.toggle("collapsed"))});const r=f();document.querySelector(".export-panel").appendChild(r),document.getElementById("export-json").addEventListener("click",async()=>{const e=document.getElementById("export-json"),t=document.getElementById("embed-images").checked,r=document.getElementById("include-comments").checked;e.disabled=!0;try{b(t?n.t("convertingImagesJSON"):n.t("exportingJSON"));const e=await d(t),i=await a(t);if(i&&(e.topicStats=i),r){b(n.t("loadingComments"));const r=await o(e=>{b(n.t("commentsLoaded").replace("{count}",e))},t);e.comments=Array.from(r.values()).sort((e,t)=>e.postNumber-t.postNumber),e.commentCount=e.comments.length}const s=function(e){return JSON.stringify(e,null,2)}(e);x(s,`linux-do-topic-${e.topic.topicId}-${Date.now()}.json`,"application/json"),b(n.t("jsonExportCompleted")),setTimeout(v,2e3)}catch(e){console.error("Export failed:",e),b(n.t("exportFailed")+e.message),setTimeout(v,3e3)}finally{e.disabled=!1}}),document.getElementById("export-html").addEventListener("click",async()=>{const e=document.getElementById("export-html"),t=document.getElementById("embed-images").checked,r=document.getElementById("include-comments").checked;e.disabled=!0;try{b(t?n.t("convertingImages"):n.t("exportingHTML"));const e=await d(t),i=await a(t);if(i&&(e.topicStats=i),r){b(n.t("loadingComments"));const r=await o(e=>{b(n.t("commentsLoaded").replace("{count}",e))},t);e.comments=Array.from(r.values()).sort((e,t)=>e.postNumber-t.postNumber),e.commentCount=e.comments.length}const s=function(e){const t=e.posts.map(e=>{const t=e.quotes.map(e=>({...e,content:c(e.content)}));return{...e,content:c(e.content),quotes:t}}),o=n.t("searchPlaceholder"),r=n.t("noResults"),a=n.t("showAll"),i=n.t("lightTheme"),s=n.t("darkTheme"),p=n.t("autoTheme");return n.t("theme"),`<!DOCTYPE html>\n<html lang="${n.currentLang}">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${e.topic.title} - Linux.do</title>\n    <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n\n    :root {\n      --bg-primary: #ffffff;\n      --bg-secondary: #f8f9fa;\n      --bg-tertiary: #f1f3f5;\n      --text-primary: #1a1a1a;\n      --text-secondary: #6c757d;\n      --text-tertiary: #adb5bd;\n      --border-color: #e9ecef;\n      --accent-color: #495057;\n      --hover-bg: #f8f9fa;\n      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);\n      --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.06);\n      --radius-sm: 4px;\n      --radius-md: 8px;\n      --radius-lg: 12px;\n    }\n\n    [data-theme="dark"] {\n      --bg-primary: #1a1a1a;\n      --bg-secondary: #242424;\n      --bg-tertiary: #2d2d2d;\n      --text-primary: #e9ecef;\n      --text-secondary: #adb5bd;\n      --text-tertiary: #6c757d;\n      --border-color: #3d3d3d;\n      --accent-color: #adb5bd;\n      --hover-bg: #2d2d2d;\n      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.2);\n      --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.3);\n    }\n\n    @media (prefers-color-scheme: dark) {\n      :root:not([data-theme="light"]) {\n        --bg-primary: #1a1a1a;\n        --bg-secondary: #242424;\n        --bg-tertiary: #2d2d2d;\n        --text-primary: #e9ecef;\n        --text-secondary: #adb5bd;\n        --text-tertiary: #6c757d;\n        --border-color: #3d3d3d;\n        --accent-color: #adb5bd;\n        --hover-bg: #2d2d2d;\n        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.2);\n        --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.3);\n      }\n    }\n\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;\n      line-height: 1.6;\n      color: var(--text-primary);\n      background: var(--bg-secondary);\n      padding: 20px;\n      font-size: 15px;\n    }\n\n    .container { max-width: 860px; margin: 0 auto; }\n\n    .header {\n      background: var(--bg-primary);\n      padding: 32px;\n      border-radius: var(--radius-lg);\n      margin-bottom: 24px;\n      box-shadow: var(--shadow-sm);\n      border: 1px solid var(--border-color);\n    }\n\n    .header h1 {\n      font-size: 26px;\n      font-weight: 600;\n      color: var(--text-primary);\n      margin-bottom: 16px;\n      line-height: 1.3;\n    }\n\n    .topic-meta { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }\n\n    .category {\n      display: inline-flex;\n      align-items: center;\n      background: var(--bg-tertiary);\n      color: var(--text-secondary);\n      padding: 4px 12px;\n      border-radius: var(--radius-sm);\n      font-size: 13px;\n      font-weight: 500;\n      border: 1px solid var(--border-color);\n    }\n\n    .tag {\n      display: inline-flex;\n      align-items: center;\n      background: var(--bg-secondary);\n      color: var(--text-secondary);\n      padding: 4px 10px;\n      border-radius: var(--radius-sm);\n      font-size: 12px;\n      border: 1px solid var(--border-color);\n    }\n\n    .topic-info {\n      margin-top: 16px;\n      padding-top: 16px;\n      border-top: 1px solid var(--border-color);\n      font-size: 13px;\n      color: var(--text-secondary);\n      display: flex;\n      flex-wrap: wrap;\n      gap: 16px;\n    }\n\n    .topic-info-item { display: flex; align-items: center; gap: 4px; }\n    .topic-info-label { font-weight: 500; color: var(--text-secondary); }\n\n    .topic-info a {\n      color: var(--text-secondary);\n      text-decoration: none;\n      border-bottom: 1px solid transparent;\n      transition: all 0.2s;\n    }\n\n    .topic-info a:hover { color: var(--text-primary); border-bottom-color: var(--text-primary); }\n\n    .topic-participants {\n      margin-top: 16px;\n      padding-top: 16px;\n      border-top: 1px solid var(--border-color);\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      flex-wrap: wrap;\n    }\n\n    .participants-list {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 8px;\n    }\n\n    .participant {\n      position: relative;\n      display: inline-block;\n      text-decoration: none;\n    }\n\n    .participant-avatar {\n      width: 36px;\n      height: 36px;\n      border-radius: 50%;\n      border: 2px solid var(--border-color);\n      transition: transform 0.2s, border-color 0.2s;\n    }\n\n    .participant:hover .participant-avatar {\n      transform: scale(1.1);\n      border-color: var(--accent-color);\n    }\n\n    .participant-count {\n      position: absolute;\n      bottom: -2px;\n      right: -2px;\n      background: var(--accent-color);\n      color: var(--bg-primary);\n      font-size: 10px;\n      font-weight: 600;\n      padding: 1px 5px;\n      border-radius: 10px;\n      min-width: 16px;\n      text-align: center;\n    }\n\n    .post {\n      background: var(--bg-primary);\n      padding: 24px;\n      margin-bottom: 16px;\n      border-radius: var(--radius-md);\n      border: 1px solid var(--border-color);\n      box-shadow: var(--shadow-sm);\n      transition: box-shadow 0.2s;\n    }\n\n    .post:hover { box-shadow: var(--shadow-md); }\n\n    .post-header {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      margin-bottom: 16px;\n      padding-bottom: 16px;\n      border-bottom: 1px solid var(--border-color);\n    }\n\n    .avatar {\n      width: 40px;\n      height: 40px;\n      border-radius: 50%;\n      object-fit: cover;\n      border: 2px solid var(--border-color);\n      flex-shrink: 0;\n    }\n\n    .author-info { flex: 1; min-width: 0; }\n\n    .author-name {\n      font-weight: 600;\n      color: var(--text-primary);\n      text-decoration: none;\n      font-size: 14px;\n      display: inline-block;\n      transition: color 0.2s;\n    }\n\n    .author-name:hover { color: var(--accent-color); }\n    .post-date { color: var(--text-tertiary); font-size: 13px; margin-top: 2px; }\n\n    .post-number {\n      background: var(--bg-tertiary);\n      padding: 4px 10px;\n      border-radius: var(--radius-sm);\n      font-size: 12px;\n      color: var(--text-secondary);\n      font-weight: 500;\n      border: 1px solid var(--border-color);\n      flex-shrink: 0;\n    }\n\n    .reply-to {\n      background: var(--bg-secondary);\n      padding: 8px 12px;\n      border-radius: var(--radius-sm);\n      margin-bottom: 16px;\n      font-size: 13px;\n      color: var(--text-secondary);\n      border-left: 2px solid var(--border-color);\n    }\n\n    .post-content { color: var(--text-primary); line-height: 1.7; }\n    .post-content p { margin: 0 0 16px 0; }\n    .post-content p:last-child { margin-bottom: 0; }\n\n    .post-content h1, .post-content h2, .post-content h3, .post-content h4, .post-content h5, .post-content h6 {\n      margin: 24px 0 16px 0;\n      font-weight: 600;\n      color: var(--text-primary);\n      line-height: 1.3;\n    }\n\n    .post-content h1 { font-size: 24px; }\n    .post-content h2 { font-size: 20px; }\n    .post-content h3 { font-size: 18px; }\n    .post-content h4 { font-size: 16px; }\n\n    .post-content img {\n      max-width: 100%;\n      height: auto;\n      margin: 16px 0;\n      border-radius: var(--radius-sm);\n      border: 1px solid var(--border-color);\n      display: block;\n    }\n\n    .post-content a {\n      color: var(--text-primary);\n      text-decoration: none;\n      border-bottom: 1px solid var(--border-color);\n      transition: all 0.2s;\n    }\n\n    .post-content a:hover { border-bottom-color: var(--text-primary); }\n    .post-content ul, .post-content ol { margin: 16px 0; padding-left: 24px; }\n    .post-content li { margin: 8px 0; }\n\n    .post-content blockquote, .post-content aside.quote {\n      background: var(--bg-secondary);\n      border-left: 3px solid var(--border-color);\n      padding: 12px 16px;\n      margin: 16px 0;\n      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;\n      color: var(--text-secondary);\n      font-size: 14px;\n    }\n\n    .post-content pre {\n      background: var(--bg-tertiary);\n      padding: 16px;\n      border-radius: var(--radius-sm);\n      overflow-x: auto;\n      margin: 16px 0;\n      border: 1px solid var(--border-color);\n      font-size: 13px;\n      line-height: 1.5;\n    }\n\n    .post-content code {\n      background: var(--bg-tertiary);\n      padding: 2px 6px;\n      border-radius: 3px;\n      font-family: 'SF Mono', 'Consolas', 'Monaco', 'Courier New', monospace;\n      font-size: 13px;\n      border: 1px solid var(--border-color);\n    }\n\n    .post-content pre code { background: transparent; padding: 0; border: none; }\n\n    .post-content table { width: 100%; border-collapse: collapse; margin: 16px 0; font-size: 14px; }\n    .post-content table th, .post-content table td { padding: 10px 12px; text-align: left; border: 1px solid var(--border-color); }\n    .post-content table th { background: var(--bg-tertiary); font-weight: 600; }\n    .post-content table tr:nth-child(even) { background: var(--bg-secondary); }\n    .post-content hr { border: none; border-top: 1px solid var(--border-color); margin: 24px 0; }\n\n    .export-info {\n      margin-top: 32px;\n      padding: 16px;\n      background: var(--bg-primary);\n      border-radius: var(--radius-md);\n      text-align: center;\n      font-size: 13px;\n      color: var(--text-tertiary);\n      border: 1px solid var(--border-color);\n    }\n\n    @media (max-width: 768px) {\n      body { padding: 12px; }\n      .header { padding: 20px; }\n      .header h1 { font-size: 22px; }\n      .post { padding: 16px; }\n      .post-header { flex-wrap: wrap; }\n      .avatar { width: 36px; height: 36px; }\n      .topic-info { flex-direction: column; gap: 8px; }\n    }\n\n    @media (max-width: 480px) {\n      body { font-size: 14px; }\n      .header h1 { font-size: 20px; }\n      .post-content { font-size: 14px; }\n    }\n\n    @media print {\n      body { background: white; padding: 0; }\n      .post { box-shadow: none; border: 1px solid #ddd; page-break-inside: avoid; }\n      .post-content a { color: var(--text-primary); text-decoration: none; border-bottom: none; }\n      .toolbar { display: none !important; }\n    }\n\n    /* Toolbar Styles */\n    .toolbar {\n      background: var(--bg-primary);\n      padding: 16px;\n      border-radius: var(--radius-md);\n      margin-bottom: 16px;\n      display: flex;\n      gap: 12px;\n      align-items: center;\n      flex-wrap: wrap;\n      border: 1px solid var(--border-color);\n      box-shadow: var(--shadow-sm);\n    }\n\n    .search-wrapper {\n      flex: 1;\n      min-width: 200px;\n      position: relative;\n    }\n\n    .search-input {\n      width: 100%;\n      padding: 10px 40px 10px 14px;\n      border: 1px solid var(--border-color);\n      border-radius: var(--radius-sm);\n      font-size: 14px;\n      background: var(--bg-secondary);\n      color: var(--text-primary);\n      outline: none;\n      transition: all 0.2s;\n    }\n\n    .search-input::placeholder { color: var(--text-tertiary); }\n    .search-input:focus { border-color: var(--accent-color); box-shadow: 0 0 0 2px rgba(73, 80, 87, 0.1); }\n\n    .search-clear {\n      position: absolute;\n      right: 10px;\n      top: 50%;\n      transform: translateY(-50%);\n      background: none;\n      border: none;\n      color: var(--text-tertiary);\n      cursor: pointer;\n      font-size: 18px;\n      padding: 4px;\n      line-height: 1;\n      display: none;\n    }\n\n    .search-clear.visible { display: block; }\n    .search-clear:hover { color: var(--text-secondary); }\n\n    .theme-selector {\n      position: relative;\n    }\n\n    .theme-select {\n      appearance: none;\n      -webkit-appearance: none;\n      -moz-appearance: none;\n      background: var(--bg-secondary);\n      border: 1px solid var(--border-color);\n      border-radius: var(--radius-sm);\n      padding: 8px 36px 8px 12px;\n      font-size: 14px;\n      font-weight: 500;\n      color: var(--text-primary);\n      cursor: pointer;\n      outline: none;\n      transition: all 0.2s;\n      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236c757d' d='M2 4l4 4 4-4'/%3E%3C/svg%3E");\n      background-repeat: no-repeat;\n      background-position: right 12px center;\n      min-width: 120px;\n    }\n\n    .theme-select:hover {\n      border-color: var(--accent-color);\n      background-color: var(--hover-bg);\n    }\n\n    .theme-select:focus {\n      border-color: var(--accent-color);\n      box-shadow: 0 0 0 2px rgba(73, 80, 87, 0.1);\n    }\n\n    .theme-select option {\n      background: var(--bg-primary);\n      color: var(--text-primary);\n      padding: 8px;\n    }\n\n    .no-results {\n      background: var(--bg-primary);\n      padding: 40px 20px;\n      text-align: center;\n      border-radius: var(--radius-md);\n      border: 1px solid var(--border-color);\n      color: var(--text-secondary);\n      display: none;\n    }\n\n    .no-results.visible { display: block; }\n    .no-results-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.5; }\n    .no-results-text { font-size: 16px; margin-bottom: 16px; }\n\n    .show-all-btn {\n      padding: 8px 16px;\n      background: var(--bg-tertiary);\n      border: 1px solid var(--border-color);\n      border-radius: var(--radius-sm);\n      color: var(--text-primary);\n      font-size: 14px;\n      cursor: pointer;\n      transition: all 0.2s;\n    }\n\n    .show-all-btn:hover { background: var(--hover-bg); }\n    .post.hidden { display: none; }\n    .comment.hidden { display: none; }\n\n    /* Comments Section Styles */\n    .comments-section {\n      margin-top: 32px;\n      padding-top: 24px;\n      border-top: 2px solid var(--border-color);\n    }\n\n    .comments-header {\n      font-size: 20px;\n      font-weight: 600;\n      color: var(--text-primary);\n      margin-bottom: 20px;\n      padding-bottom: 12px;\n      border-bottom: 1px solid var(--border-color);\n    }\n\n    .comment {\n      background: var(--bg-primary);\n      padding: 20px;\n      margin-bottom: 12px;\n      border-radius: var(--radius-md);\n      border: 1px solid var(--border-color);\n      box-shadow: var(--shadow-sm);\n      transition: box-shadow 0.2s;\n    }\n\n    .comment:hover { box-shadow: var(--shadow-md); }\n\n    .comment .post-header {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      margin-bottom: 12px;\n      padding-bottom: 12px;\n      border-bottom: 1px solid var(--border-color);\n    }\n\n    .comment .avatar {\n      width: 36px;\n      height: 36px;\n    }\n\n    .comment .user-title {\n      display: inline-block;\n      background: var(--bg-tertiary);\n      color: var(--text-secondary);\n      padding: 2px 8px;\n      border-radius: var(--radius-sm);\n      font-size: 11px;\n      margin-left: 8px;\n      font-weight: 500;\n    }\n\n    .quote-block {\n      background: var(--bg-secondary);\n      border-left: 3px solid var(--border-color);\n      padding: 12px 16px;\n      margin-bottom: 12px;\n      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;\n    }\n\n    .quote-header {\n      font-size: 12px;\n      color: var(--text-secondary);\n      font-weight: 500;\n      margin-bottom: 8px;\n    }\n\n    .quote-block blockquote {\n      margin: 0;\n      padding: 0;\n      border: none;\n      background: transparent;\n      color: var(--text-secondary);\n      font-size: 14px;\n    }\n\n    .search-highlight { background: #fff3cd; padding: 1px 2px; border-radius: 2px; }\n    [data-theme="dark"] .search-highlight { background: #5a4b00; }\n    @media (prefers-color-scheme: dark) {\n      :root:not([data-theme="light"]) .search-highlight { background: #5a4b00; }\n    }\n\n    @media (max-width: 768px) {\n      .toolbar { flex-direction: column; align-items: stretch; }\n      .search-wrapper { width: 100%; }\n      .theme-toggle { justify-content: center; }\n    }\n  </style>\n</head>\n<body>\n    <div class="container">\n        <div class="header">\n            <h1>${e.topic.title}</h1>\n            <div class="topic-meta">\n                ${e.topic.category?`<span class="category">${e.topic.category}</span>`:""}\n                ${e.topic.tags.map(e=>`<span class="tag">${e}</span>`).join("")}\n            </div>\n            <div class="topic-info">\n                <div class="topic-info-item">\n                    <span class="topic-info-label">${n.t("topicID")}:</span>\n                    <span>${e.topic.topicId}</span>\n                </div>\n                <div class="topic-info-item">\n                    <span class="topic-info-label">${n.t("posts")}:</span>\n                    <span>${e.postCount}</span>\n                </div>\n                ${e.topicStats?`\n                <div class="topic-info-item">\n                    <span class="topic-info-label">${n.t("views")}:</span>\n                    <span>${e.topicStats.views||0}</span>\n                </div>\n                <div class="topic-info-item">\n                    <span class="topic-info-label">${n.t("likes")}:</span>\n                    <span>${e.topicStats.likes||0}</span>\n                </div>\n                `:""}\n                <div class="topic-info-item">\n                    <span class="topic-info-label">${n.t("source")}:</span>\n                    <a href="${e.topic.url}" target="_blank">linux.do</a>\n                </div>\n            </div>\n            ${e.topicStats&&e.topicStats.participants&&e.topicStats.participants.length>0?`\n            <div class="topic-participants">\n                <span class="topic-info-label">${n.t("participants")}:</span>\n                <div class="participants-list">\n                    ${e.topicStats.participants.map(e=>`\n                    <a href="https://linux.do/u/${e.username}" class="participant" title="${e.displayName||e.username}">\n                        <img src="${e.avatarUrl}" alt="${e.username}" class="participant-avatar">\n                        ${e.postCount>1?`<span class="participant-count">${e.postCount}</span>`:""}\n                    </a>\n                    `).join("")}\n                </div>\n            </div>\n            `:""}\n        </div>\n\n        <div class="toolbar">\n            <div class="search-wrapper">\n                <input type="text" class="search-input" id="searchInput" placeholder="${o}">\n                <button class="search-clear" id="searchClear">&times;</button>\n            </div>\n            <div class="theme-selector">\n                <select id="themeSelect" class="theme-select">\n                    <option value="auto">üåó ${p}</option>\n                    <option value="light">‚òÄÔ∏è ${i}</option>\n                    <option value="dark">üåô ${s}</option>\n                </select>\n            </div>\n        </div>\n\n        <div class="no-results" id="noResults">\n            <div class="no-results-icon">üîç</div>\n            <div class="no-results-text">${r}</div>\n            <button class="show-all-btn" id="showAllBtn">${a}</button>\n        </div>\n\n        ${t.map(e=>`\n        <div class="post" id="post-${e.postNumber}" data-author="${e.author.username}" data-content="${m(e.contentText.substring(0,1e3))}">\n            <div class="post-header">\n                ${e.author.avatarUrl?`<img src="${e.author.avatarUrl}" alt="${e.author.username}" class="avatar">`:""}\n                <div class="author-info">\n                    <a href="https://linux.do${e.author.profileUrl}" class="author-name">${e.author.username}</a>\n                    <div class="post-date">${e.dateFormatted}</div>\n                </div>\n                <span class="post-number">#${e.postNumber}</span>\n            </div>\n\n            ${e.replyTo?`\n            <div class="reply-to">\n                ‚Ü© ${n.t("replyTo")} @${e.replyTo.username}\n            </div>\n            `:""}\n\n            <div class="post-content">\n                ${e.content}\n            </div>\n        </div>\n        `).join("")}\n\n        ${e.comments&&e.comments.length>0?`\n        <div class="comments-section">\n            <h2 class="comments-header">${n.t("comments")} (${e.commentCount})</h2>\n            ${e.comments.map(e=>`\n            <div class="comment" id="comment-${e.postNumber}" data-author="${e.author.username}" data-content="${m(e.contentText.substring(0,1e3))}">\n                <div class="post-header">\n                    ${e.author.avatarUrl?`<img src="${e.author.avatarUrl}" alt="${e.author.username}" class="avatar">`:""}\n                    <div class="author-info">\n                        <a href="https://linux.do${e.author.profileUrl}" class="author-name">${e.author.username}</a>\n                        ${e.author.title?`<span class="user-title">${e.author.title}</span>`:""}\n                        <div class="post-date">${e.dateTitle||e.dateFormatted}</div>\n                    </div>\n                    <span class="post-number">#${e.postNumber}</span>\n                </div>\n\n                ${e.quotes&&e.quotes.length>0?e.quotes.map(e=>`\n                <div class="quote-block">\n                    <div class="quote-header">@${e.username} #${e.postNumber}</div>\n                    <blockquote>${c(e.content)}</blockquote>\n                </div>\n                `).join(""):""}\n\n                <div class="post-content">\n                    ${c(e.content)}\n                </div>\n            </div>\n            `).join("")}\n        </div>\n        `:""}\n\n        <div class="export-info">\n            ${n.t("exportedFrom")} ${n.formatDate(e.exportDate)}\n        </div>\n    </div>\n\n    <script>\n        (function() {\n            // Theme switching\n            const themeSelect = document.getElementById('themeSelect');\n            const htmlElement = document.documentElement;\n            \n            function setTheme(theme) {\n                themeSelect.value = theme;\n                \n                if (theme === 'auto') {\n                    htmlElement.removeAttribute('data-theme');\n                } else {\n                    htmlElement.setAttribute('data-theme', theme);\n                }\n                \n                localStorage.setItem('theme', theme);\n            }\n            \n            // Load saved theme\n            const savedTheme = localStorage.getItem('theme') || 'auto';\n            setTheme(savedTheme);\n            \n            themeSelect.addEventListener('change', function() {\n                setTheme(this.value);\n            });\n            \n            // Search functionality\n            const searchInput = document.getElementById('searchInput');\n            const searchClear = document.getElementById('searchClear');\n            const noResults = document.getElementById('noResults');\n            const showAllBtn = document.getElementById('showAllBtn');\n            const posts = document.querySelectorAll('.post');\n            \n            let searchTimeout;\n            \n            function performSearch(query) {\n                const normalizedQuery = query.toLowerCase().trim();\n                let visibleCount = 0;\n                \n                posts.forEach(post => {\n                    const author = (post.getAttribute('data-author') || '').toLowerCase();\n                    const content = (post.getAttribute('data-content') || '').toLowerCase();\n                    const postContent = post.querySelector('.post-content');\n                    const originalContent = postContent.getAttribute('data-original') || postContent.innerHTML;\n                    \n                    if (!postContent.getAttribute('data-original')) {\n                        postContent.setAttribute('data-original', postContent.innerHTML);\n                    }\n                    \n                    if (!normalizedQuery) {\n                        post.classList.remove('hidden');\n                        postContent.innerHTML = originalContent;\n                        visibleCount++;\n                        return;\n                    }\n                    \n                    const matches = author.includes(normalizedQuery) || content.includes(normalizedQuery);\n                    \n                    if (matches) {\n                        post.classList.remove('hidden');\n                        visibleCount++;\n                    } else {\n                        post.classList.add('hidden');\n                    }\n                });\n                \n                if (visibleCount === 0 && normalizedQuery) {\n                    noResults.classList.add('visible');\n                } else {\n                    noResults.classList.remove('visible');\n                }\n                \n                if (query) {\n                    searchClear.classList.add('visible');\n                } else {\n                    searchClear.classList.remove('visible');\n                }\n            }\n            \n            searchInput.addEventListener('input', function() {\n                clearTimeout(searchTimeout);\n                searchTimeout = setTimeout(() => {\n                    performSearch(this.value);\n                }, 200);\n            });\n            \n            searchClear.addEventListener('click', function() {\n                searchInput.value = '';\n                performSearch('');\n                searchInput.focus();\n            });\n            \n            showAllBtn.addEventListener('click', function() {\n                searchInput.value = '';\n                performSearch('');\n            });\n            \n            // Keyboard shortcut: Ctrl/Cmd + F to focus search\n            document.addEventListener('keydown', function(e) {\n                if ((e.ctrlKey || e.metaKey) && e.key === 'f') {\n                    e.preventDefault();\n                    searchInput.focus();\n                    searchInput.select();\n                }\n            });\n        })();\n    <\/script>\n</body>\n</html>`}(e);x(s,`linux-do-topic-${e.topic.topicId}-${Date.now()}.html`,"text/html"),b(n.t("htmlExportCompleted")),setTimeout(v,2e3)}catch(e){console.error("Export failed:",e),b(n.t("exportFailed")+e.message),setTimeout(v,3e3)}finally{e.disabled=!1}}),document.getElementById("export-markdown").addEventListener("click",async()=>{const e=document.getElementById("export-markdown"),t=document.getElementById("embed-images").checked,r=document.getElementById("include-comments").checked;e.disabled=!0;try{b(t?n.t("convertingImagesMarkdown"):n.t("exportingMarkdown"));const e=await d(t),i=await a(t);if(i&&(e.topicStats=i),r){b(n.t("loadingComments"));const r=await o(e=>{b(n.t("commentsLoaded").replace("{count}",e))},t);e.comments=Array.from(r.values()).sort((e,t)=>e.postNumber-t.postNumber),e.commentCount=e.comments.length}const s=function(e){let t="";if(t+=`# ${e.topic.title}\n\n`,e.topic.category?(t+=`**${n.t("topicID")}:** ${e.topic.topicId}  \n`,t+=`**Category:** ${e.topic.category}  \n`):t+=`**${n.t("topicID")}:** ${e.topic.topicId}  \n`,e.topic.tags&&e.topic.tags.length>0&&(t+=`**Tags:** ${e.topic.tags.map(e=>`\`${e}\``).join(", ")}  \n`),t+=`**${n.t("source")}:** [linux.do](${e.topic.url})  \n`,t+=`**${n.t("posts")}:** ${e.postCount}  \n`,e.topicStats&&(e.topicStats.views&&(t+=`**${n.t("views")}:** ${e.topicStats.views}  \n`),e.topicStats.likes&&(t+=`**${n.t("likes")}:** ${e.topicStats.likes}  \n`),e.topicStats.participants&&e.topicStats.participants.length>0)){const o=e.topicStats.participants.map(e=>`@${e.username}`).join(", ");t+=`**${n.t("participants")}:** ${o}  \n`}return t+="\n---\n\n",e.posts.forEach((o,r)=>{t+=`## #${o.postNumber} - ${o.author.username}\n\n`,t+=`*${o.dateFormatted}*\n\n`,o.replyTo&&(t+=`> ${n.t("replyTo")} @${o.replyTo.username}\n\n`),o.quotes&&o.quotes.length>0&&o.quotes.forEach(e=>{const o=u(e.content);t+=`> **@${e.username}** (${n.t("replyTo")} #${e.postNumber}):\n`,o.split("\n").forEach(e=>{t+=`> ${e}\n`}),t+="\n"});const a=u(o.content);t+=a+"\n\n",o.reactions&&o.reactions.length>0&&(t+=`**Reactions:** ${o.reactions.map(e=>`${e.emoji} ${e.count}`).join(" | ")}\n\n`),r<e.posts.length-1&&(t+="---\n\n")}),e.comments&&e.comments.length>0&&(t+="\n---\n\n",t+=`## ${n.t("comments")} (${e.commentCount})\n\n`,e.comments.forEach((n,o)=>{t+=`### #${n.postNumber} - ${n.author.username}`,n.author.title&&(t+=` (${n.author.title})`),t+="\n\n",t+=`*${n.dateTitle||n.dateFormatted}*\n\n`,n.quotes&&n.quotes.length>0&&n.quotes.forEach(e=>{const n=u(e.content);t+=`> **@${e.username}** (#${e.postNumber}):\n`,n.split("\n").forEach(e=>{t+=`> ${e}\n`}),t+="\n"});const r=u(n.content);t+=r+"\n\n",o<e.comments.length-1&&(t+="---\n\n")})),t+="\n---\n\n",t+=`*${n.t("exportedFrom")} ${n.formatDate(e.exportDate)}*\n`,t}(e);x(s,`linux-do-topic-${e.topic.topicId}-${Date.now()}.md`,"text/markdown"),b(n.t("markdownExportCompleted")),setTimeout(v,2e3)}catch(e){console.error("Export failed:",e),b(n.t("exportFailed")+e.message),setTimeout(v,3e3)}finally{e.disabled=!1}})}!async function(){try{b(n.t("loadingPosts")),await function(e=3e4){return new Promise((t,o)=>{const r=Date.now(),a=setInterval(()=>{document.querySelectorAll("article[data-post-id]").length>0?(clearInterval(a),t()):Date.now()-r>e&&(clearInterval(a),o(new Error(n.t("noPostsFound"))))},500)})}(),v(),y(),console.log(n.t("scriptInitialized")+" v2.1.0")}catch(e){v(),console.error("Linux.do Exporter:",e.message)}}()})();